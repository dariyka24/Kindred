import{g as e,a as w,d as q,e as E,f as R,r as D,c as x,b as J,s as O,p as U}from"./firebace-Cb3kG9CG.js";import{J as z}from"./just-validate.es-C73wyOde.js";import{I as A}from"./index-yFKSUj0c.js";const m=JSON.parse(localStorage.getItem("user")||"[]"),c=e("#name"),d=e("#surname"),h=e("#date"),p=e("#city"),g=e("#phone"),k=e("#email"),W=e("#about"),v=w('input[name="time"]');async function C(){if(!c||!d||!h||!p||!g||!k||!W||!v)return;const t=c.value,r=d.value,s=h.value,o=p.value,n=g.value,l=k.value,S=W.value;let i;if(v.forEach(u=>{if(u.checked)switch(u.id){case"all-time":i="Постійно";break;case"some-time":i="Частково";break;case"one-time":i="Разово";break;case"when-can":i="Коли зможу";break}}),!!m)try{await q(E(R,"applications"),{name:t,surname:r,date:s,city:o,phone:n,email:l,about:S,time:i,id:m.id})}catch(u){console.error(u)}}function N(){const t=D("div","done-pop-up");t.innerText="Заявку відправлено",e(".wrapper")?.appendChild(t),setTimeout(()=>{t.style.opacity="0"},5e3),setTimeout(()=>{e(".wrapper")?.removeChild(t)},6e3)}function T(){const t=e("#want-to-be");if(!t)return;V();const r=new z(t,{errorLabelStyle:{color:"#ff7d4e"},focusInvalidField:!0,lockForm:!1,validateBeforeSubmitting:!0});r.addField("#name",[{rule:"required",errorMessage:"Введіть ваше ім'я"},{rule:"minLength",value:2,errorMessage:"Довжина ім'я повинна бути більше 1 літери"},{rule:"maxLength",value:50,errorMessage:"Довжина ім'я повинна бути менше"},{rule:"customRegexp",value:/^[\p{L}’'\-]+$/u,errorMessage:"Допускаються тільки літери, апостроф та дефіс"}]).addField("#surname",[{rule:"required",errorMessage:"Введіть ваше прізвище"},{rule:"minLength",value:2,errorMessage:"Довжина прізвища повинна бути більше 1 літери"},{rule:"maxLength",value:50,errorMessage:"Довжина прізвища повинна бути менше"},{rule:"customRegexp",value:/^[\p{L}’'\-]+$/u,errorMessage:"Допускаються тільки літери, апостроф та дефіс"}]).addField("#date",[{rule:"required",errorMessage:"Це поле обовʼязкове"},{rule:"customRegexp",value:/^(0?[1-9]|[12][0-9]|3[01])[.\-\/](0?[1-9]|1[0-2])[.\-\/](19|20)\d{2}$/,errorMessage:"Введіть правильну дату у форматі дд.мм.рррр"}]).addField("#city",[{rule:"required",errorMessage:"Введіть маше місто проживання"},{rule:"minLength",value:2,errorMessage:"Довжина міста повинна бути більше 1 літери"},{rule:"maxLength",value:50,errorMessage:"Довжина міста повинна бути менше"},{rule:"customRegexp",value:/^[\p{L}]+$/u,errorMessage:"Допускаються тільки літери"}]).addField("#email",[{rule:"required",errorMessage:"Це обов'язкове поле"},{rule:"customRegexp",value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z]{2,})$/,errorMessage:"Перевірте правильність написання пошти"}]).addField("#phone",[{rule:"required",errorMessage:"Це обов'язкове поле"},{rule:"custom",validator:s=>{const o=[{mask:"+{1} (000) 000-0000",startsWith:"1"},{mask:"+{7} (000) 000-00-00",startsWith:"7"},{mask:"+{380} (00) 000-00-00",startsWith:"380"},{mask:"+{44} (0000) 000000",startsWith:"44"},{mask:"+{49} (000) 000-0000",startsWith:"49"},{mask:"+{86} (000) 0000-0000",startsWith:"86"},{mask:"+{33} (0) 0 00 00 00 00",startsWith:"33"},{mask:"+{39} 0 000 000 000",startsWith:"39"},{mask:"+{34} 000 000 000",startsWith:"34"},{mask:"+{61} (0) 0000 0000",startsWith:"61"},{mask:"+{81} (0) 0-0000-0000",startsWith:"81"},{mask:"+{91} 0000 000 000",startsWith:"91"},{mask:"+{52} (0) 000 0000 0000",startsWith:"52"},{mask:"+{55} (0) 00 0000-0000",startsWith:"55"},{mask:"+{82} (0) 0-0000-0000",startsWith:"82"},{mask:"+{90} 000 000 00 00",startsWith:"90"},{mask:"+{27} 000 000 000",startsWith:"27"},{mask:"+{64} 0 000 000 000",startsWith:"64"},{mask:"+{65} 0000 0000",startsWith:"65"},{mask:"+{48} 000 000 000",startsWith:"48"}],n=s.replace(/\D/g,"");return o.some(l=>n.startsWith(l.startsWith))},errorMessage:"Номер телефону має починатися з одного з дійсних кодів країни"}]).addField("#about",[{rule:"required",errorMessage:"Це обов'язкове поле для заповнення"},{rule:"minLength",value:20,errorMessage:"Напишіть трохи більше інформації"}]).addField("#agree",[{rule:"required",errorMessage:"Дайте згоду на обробку інформації"}]),r.onSuccess(async()=>{await C(),N()})}function V(){const t=e("#phone");t&&A(t,{mask:[{mask:"+{1} (000) 000-0000",startsWith:"1"},{mask:"+{7} (000) 000-00-00",startsWith:"7"},{mask:"+{380} (00) 000-00-00",startsWith:"380"},{mask:"+{44} (0000) 000000",startsWith:"44"},{mask:"+{49} (000) 000-0000",startsWith:"49"},{mask:"+{86} (000) 0000-0000",startsWith:"86"},{mask:"+{33} (0) 0 00 00 00 00",startsWith:"33"},{mask:"+{39} 0 000 000 000",startsWith:"39"},{mask:"+{34} 000 000 000",startsWith:"34"},{mask:"+{61} (0) 0000 0000",startsWith:"61"},{mask:"+{81} (0) 0-0000-0000",startsWith:"81"},{mask:"+{91} 0000 000 000",startsWith:"91"},{mask:"+{52} (0) 000 0000 0000",startsWith:"52"},{mask:"+{55} (0) 00 0000-0000",startsWith:"55"},{mask:"+{82} (0) 0-0000-0000",startsWith:"82"},{mask:"+{90} 000 000 00 00",startsWith:"90"},{mask:"+{27} 000 000 000",startsWith:"27"},{mask:"+{64} 0 000 000 000",startsWith:"64"},{mask:"+{65} 0000 0000",startsWith:"65"},{mask:"+{48} 000 000 000",startsWith:"48"},{mask:"+000 (00) 000-00-00",startsWith:""}],dispatch:(r,s)=>{let o=(s.value+r).replace(/\D/g,"");return s.compiledMasks.find(n=>n.startsWith&&o.startsWith(n.startsWith))||s.compiledMasks[s.compiledMasks.length-1]}})}const a=JSON.parse(localStorage.getItem("user")||"[]"),f=e("#name"),I=e("#surname"),M=e("#date"),b=e("#city"),$=e("#phone"),L=e("#email"),y=e("#about"),Z=w('input[name="time"]');function B(){!f||!I||!M||!b||!$||!L||!y||!Z||(f.value=a.name,I.value=a.surname,M.value=a.dateOfBirth,b.value=a.city,$.value=a.phone,L.value=a.email,y.value=a.about)}const K=JSON.parse(localStorage.getItem("user")||"[]"),P=x.get("UID"),F=x.get("Role");function _(){if(!K||!P){window.location.href="/Kindred/log-in.html";return}if(F==="customer"){B(),T();return}window.location.href=`/Kindred/cabinet-${F}.html`}document.addEventListener("DOMContentLoaded",async()=>{J(),_(),O()});document.addEventListener("loadingIsFinished",()=>{U()});
