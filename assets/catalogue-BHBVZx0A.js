import{g as f,a as h,b as E,s as b,p as _}from"./firebace-Cb3kG9CG.js";import{a as y,b as L}from"./render-prod-cards-BG07nqjv.js";import{g as N,a as P}from"./requests-8AYIeyfP.js";const i=f("#range"),o=f(".range-value");function w(){i&&(m(),i.addEventListener("input",()=>m()))}function m(){if(!i||!o)return;const e=i.value;Number(e)==5e3?o.value="до 5000":Number(e)==1e6?o.value="більше 1000000":o.value=`від ${e}`;const r=Number(i.min),t=Number(i.max);if(!r||!t)return;const a=`${100-(t-Number(e))/(t-r)*100}`;o.style.setProperty("--valRange",a+"%")}const T=h('.filter__list_score input[type="radio"]'),I=h('.filter__list_date input[type="radio"]');let u=null,d=null;function M(e,r){T.forEach(t=>{t.addEventListener("change",()=>{u=R(t.id),g(e,r)})}),I.forEach(t=>{t.addEventListener("change",()=>{d=t.id==="up"?"asc":"desc",g(e,r)})})}function R(e){switch(e){case"five":return 5;case"four":return 4;case"three":return 3;case"two":return 2;case"one":return 1;default:return 0}}function g(e,r){const t=f(".prod-list__content");if(!t)return;let a=[];e.forEach(n=>{const s=r.find(c=>c.id===n.userId);if(s&&!n.status){let c=0;s.score.forEach(v=>{c+=Number(v)});const p=c/s.score.length;a.push({id:n.id,img:n.img,title:n.title,goal:n.goal,collected:n.collected,userInfo:{id:s.id,name:`${s.name||"-"}.`,surname:s.surname,score:Math.round(p)},date:n.date})}}),u!==null&&(a=a.filter(n=>Number(n.userInfo.score)===u)),d==="asc"?a.sort((n,s)=>l(n.date).getTime()-l(s.date).getTime()):d==="desc"&&a.sort((n,s)=>l(s.date).getTime()-l(n.date).getTime()),t.innerHTML="",a.length===0?t.innerHTML="Не знайдено зборів за заданим фільтром.":a.forEach(n=>{y(n,t)})}function l(e){const[r,t,a]=e.split(".").map(Number);return new Date(a,t-1,r)}document.addEventListener("DOMContentLoaded",async()=>{const e=await N(),r=await P();!e||!r||(E(),w(),await L(".prod-list__content",e,r),M(e,r),b())});document.addEventListener("loadingIsFinished",()=>{_()});
